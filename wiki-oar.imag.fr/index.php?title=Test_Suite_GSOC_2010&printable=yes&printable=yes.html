<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.5-2squeeze6" />
		<meta name="robots" content="noindex,follow" />
		<meta name="keywords" content="Test Suite GSOC 2010,Kameleon,RESTfullAPI" />
		<link rel="shortcut icon" href="http://oar.imag.fr/images/logo_oar.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="WikiOAR (en)" />
		<link rel="alternate" type="application/rss+xml" title="WikiOAR RSS feed" href="index.php%3Ftitle=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="WikiOAR Atom feed" href="index.php%3Ftitle=Special:RecentChanges&amp;feed=atom" />
		<title>Test Suite GSOC 2010 - WikiOAR</title>
		<link rel="stylesheet" href="skins/common/commonPrint.css%3F207.css" type="text/css" />
		<link rel="stylesheet" href="index.php%3Ftitle=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%252Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000.css" type="text/css" />
		<link rel="stylesheet" href="index.php%3Ftitle=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%252Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000.css" type="text/css" />
		<link rel="stylesheet" href="index.php%3Ftitle=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%252Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000.css" type="text/css" />
		<link rel="stylesheet" href="index.php%3Ftitle=-&amp;action=raw&amp;maxage=18000&amp;gen=css.css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins";
		var wgArticlePath = "/index.php/$1";
		var wgScriptPath = "";
		var wgScript = "/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://wiki-oar.imag.fr";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Test_Suite_GSOC_2010";
		var wgTitle = "Test Suite GSOC 2010";
		var wgAction = "view";
		var wgArticleId = "222";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 2720;
		var wgVersion = "1.15.5-2squeeze6";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="skins/common/wikibits.js%3F207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="skins/common/ajax.js%3F207"></script>
		<script type="text/javascript" src="index.php%3Ftitle=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Test_Suite_GSOC_2010 skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Test Suite GSOC 2010</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From WikiOAR</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#column-one">navigation</a>, <a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#searchInput">search</a></div>			<!-- start content -->
			<p><b>Student and mentor&nbsp;;), please read carefully this page...</b>
</p><p>Student: <b>Narayanan K</b>
</p><p>Mentor: Joseph Emeras
</p><p>Co-Mentor: Yiannis Georgiou
</p>
<hr />
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#Student:_Things_to_do_before_starting"><span class="tocnumber">1</span> <span class="toctext">Student: Things to do before starting</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#Main_Milestones"><span class="tocnumber">2</span> <span class="toctext">Main Milestones</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#What_are_we_testing_and_How.3F"><span class="tocnumber">3</span> <span class="toctext">What are we testing and How?</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#RSpec_Ruby_Test_Framework"><span class="tocnumber">4</span> <span class="toctext">RSpec Ruby Test Framework</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#Regular_RSpec_Testing_Method"><span class="tocnumber">5</span> <span class="toctext">Regular RSpec Testing Method</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#The_Kameleon_way_of_Testing:_Idea"><span class="tocnumber">6</span> <span class="toctext">The Kameleon way of Testing: Idea</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#Testsuite_Installation"><span class="tocnumber">7</span> <span class="toctext">Testsuite Installation</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#The_Testsuite_Engine_Design"><span class="tocnumber">8</span> <span class="toctext">The Testsuite Engine Design</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#Advantages"><span class="tocnumber">9</span> <span class="toctext">Advantages</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#Sample_Test_Recipe_snippet"><span class="tocnumber">10</span> <span class="toctext">Sample Test Recipe snippet</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#Schema"><span class="tocnumber">11</span> <span class="toctext">Schema</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#List_of_rspectests_lib_methods"><span class="tocnumber">12</span> <span class="toctext">List of rspectests_lib methods</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#List_of_oarrestapi_lib_methods"><span class="tocnumber">13</span> <span class="toctext">List of oarrestapi_lib methods</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html#TODO_list"><span class="tocnumber">14</span> <span class="toctext">TODO list</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Student:_Things_to_do_before_starting" id="Student:_Things_to_do_before_starting"></a><h2> <span class="mw-headline">Student: Things to do before starting</span></h2>
<ul><li> <s>Subscribe to oar commits mailing list</s>
</li><li> <s>Play with <a href="index.php/Kameleon.html" title="Kameleon">Kameleon</a> (generate a OAR/Debian appliance)</s>
</li><li> <s>Practice <a href="index.php/RESTfullAPI.html" title="RESTfullAPI"> OAR RESTfull API</a> (using the OAR appliance)</s>
</li><li> <s>Compute a summary of available tools for functional testing in ruby</s>
</li></ul>
<a name="Main_Milestones" id="Main_Milestones"></a><h2> <span class="mw-headline">Main Milestones</span></h2>
<ul><li> July 5 - 15: Implement the testsuite engine and recipe to test the basic REST OAR APIs and few scenario testings.
</li></ul>
<a name="What_are_we_testing_and_How.3F" id="What_are_we_testing_and_How.3F"></a><h2> <span class="mw-headline">What are we testing and How?</span></h2>
<p>The main aim of this project is to test the available OAR REST APIs to ensure that they are working as expected without any broken links while calling the APIs for implementing various functionalities.<br />
A list of available OAR REST APIs is present in the Documentation which can be pulled from <a href="index.php/OAR_API.html" class="external free" title="http://wiki-oar.imag.fr/index.php/OAR_API" rel="nofollow">http://wiki-oar.imag.fr/index.php/OAR_API</a> <br />
Both <b>unit testing</b> as well and <b>functional(Scenario)</b> testing will be done on the OAR REST APIs.<br />
So, we currently make available 2 ways of testing the APIs. They are as follows:<br />
1. <b>Regular RSpec Testing</b><br />
2. <b>Testing using Kameleon Tool, IRB and RSpec</b><br />
</p><p>So users of the APIs who are familiar with RSpec Test framework can use the first method of testing, while those developers who are fond of Kameleon tool and love to write recipes and steps can pick up the second option for testing the APIs.<br />
</p><p>In this Wiki, we cover the basics of how testcases can be written, by using both the methods mentioned above.<br />
Before launching onto the 2 testing methods, let us understand about the RSpec Ruby Testing Framework which is common in both the methodologies. We cover that next.<br />
</p>
<a name="RSpec_Ruby_Test_Framework" id="RSpec_Ruby_Test_Framework"></a><h2> <span class="mw-headline">RSpec Ruby Test Framework</span></h2>
<p><b>Rspec</b> is a behavior driven test development framework developed for Ruby.<br /> 
Behavior Driven Development(<b>BDD</b>) began its journey as an attempt to better understand and explain the process of Test Driven Development.<br />
Behavior driven development is an agile software development technique .<br />
RSpec uses simple plain English like statements to write test cases. <br />
In Testsuites project, we use RSpec to carry out <b>unit/scenario testing</b> of the various OAR REST APIs.<br />
<b>RSpec Documentation</b> with examples of simple scenario testing of OAR APIs can be pulled from gforge scm - branch/gsoc2010/tests/testsuite/Documentation.
</p>
<a name="Regular_RSpec_Testing_Method" id="Regular_RSpec_Testing_Method"></a><h2> <span class="mw-headline">Regular RSpec Testing Method</span></h2>
<p>This is the most easiest and quickest way to test the OAR APIs.<br />
Once testing using RSpec framework is clear, one can write very efficient testcases (testelements)for scenarios/unit functioning of APIs in a few minutes and run them on the fly using the <b>spec</b> command.<br />
A Testsuite can be made by placing all the test files (must end with _spec.rb) in a spec folder. <br />
By running the command: <b>spec path_to_spec_folder --format specdoc</b> , each test spec file in the directory will get executed one by one displaying the result for each test file after it is run.<br />
</p><p>The RSpec Documentation I made, clarifies how this method of testing can be done with examples. But however for the sake of completeness, I will describe a small example of testing of APIs using simple RSpec testelements.
</p><p>Following are testelements to submit a job successfully and check the queue if job has been submitted. Note: jobid is made global so that all testelements can test APIs that require this jobid. Also submit_job and full_job_details are methods of library oarrestapi that calls the POST/GET APIs which are called using the object of the library class. Read RSpec Documentation for more details. Assume the elements are from file testspec.rb.
</p>
<pre> #Submitting a job
 it "should submit a job successfully " do
 jhash = { 'resource' =&gt; "/nodes=1/core=1" , 'script' =&gt; "ls;pwd;whoami;sleep 60" }
 begin
 @obj.submit_job(jhash)
 $jobid = @obj.jobstatus['id'].to_s
 rescue
   puts "#{$!}"
   exit
 end
 $!.should == "" #Usually returns NULL or empty string
 @obj.jobstatus['status'].to_s.should == "submitted"  
 end
</pre>
<pre> #Checking the queue (Can use GET /jobs to check) immediately.
 it "should contain jobid in queue of created job" do
 begin
 @obj.full_job_details
 rescue
   puts "#{$!}"
   exit
 end
 @obj.jobarray['items'] do |value|
 if  value['job_id']== $jobid
 @c=1
 end
 end  
 $!.should == ""
 @c.should == 1
 end 
</pre>
<p>The testelement passes only if each should or should_not methods inside it are succeeding. If one fails, the testelement fails.<br />
Running using spec&nbsp;: $ <b>spec testspec.rb --format specdoc</b> <br />
<i>OarApis<br /></i>
- should submit a job successfully <br />
- should contain jobid in queue of created job <br />
Finished in 03.062151 seconds <br />
2 examples, 0 failures<br />
</p><p>Thus tests can be written and run easily as shown above. <br />
The next method is for Kameleon fans and is described elaborately in the sections that follow.
</p>
<a name="The_Kameleon_way_of_Testing:_Idea" id="The_Kameleon_way_of_Testing:_Idea"></a><h2> <span class="mw-headline">The Kameleon way of Testing: Idea</span></h2>
<p>Main Tools used in this Idea:
</p>
<ul><li> <b>Kameleon</b>
</li><li> <b>Interactive Ruby (IRB)</b>
</li><li> <b>RSpec Ruby Gem - A Ruby BDD Testing framework</b>
</li></ul>
<p>Tests will be written in simple yaml file format. Kameleon engine can be used to parse the yaml test files. <br />
Recipe Test file will contain macrosteps and microsteps. <br />
The actual testing is done using the RSpec Testing Framework internally.<br />
An IRB Session is opened up in one of the microsteps. Named FIFO pipes are used for giving input and collecting back output/error to and from the IRB respectively.
A library of RSpec test elements of the REST OAR APIs along with few scenario testing are made. This library is loaded in IRB in one of the microsteps and testings mapped with the corresponding macrosteps are run in IRB.<br />
Ruby commands to load RSpec test library and to run the tests are given as input to the IRB via the named FIFO pipe. Similarly, output/errors of these tests run in IRB are collected back in other named pipes.
<br />
</p>
<a name="Testsuite_Installation" id="Testsuite_Installation"></a><h2> <span class="mw-headline">Testsuite Installation</span></h2>
<p><a href="index.php/File:Testsuite_installation.jpg.html" class="image" title="Image:Testsuite_installation.jpg"><img alt="Image:Testsuite_installation.jpg" src="images/7/7e/Testsuite_installation.jpg" width="848" height="454" border="0" /></a>
</p>
<a name="The_Testsuite_Engine_Design" id="The_Testsuite_Engine_Design"></a><h2> <span class="mw-headline">The Testsuite Engine Design</span></h2>
<p>An overall tentative architecture of the testsuite has been drawn and committed to the Inria SVN Repository (gsoc2010/tests/testsuite/Design).<br />
<a href="index.php/File:Testsuite_Design.jpg.html" class="image" title="Image:Testsuite_Design.jpg"><img alt="Image:Testsuite_Design.jpg" src="images/7/76/Testsuite_Design.jpg" width="468" height="634" border="0" /></a>
</p>
<a name="Advantages" id="Advantages"></a><h2> <span class="mw-headline">Advantages</span></h2>
<ul><li> Test files can be easily written as it is in the standard YAML format.
</li><li> Usage of Kameleon engine will make parsing of test files quicker, powerful and efficient. All features of kameleon is derived here.
</li><li> Inner test cases made using RSpec, which is easier to learn, code; takes just few minutes to add a new spec test element to the rspec test library.
</li><li> Since each test is carried out in IRB through kameleon, debugging is easy at each step.
</li></ul>
<a name="Sample_Test_Recipe_snippet" id="Sample_Test_Recipe_snippet"></a><h2> <span class="mw-headline">Sample Test Recipe snippet</span></h2>
<p>A sample steps of test recipe will tentatively look like: 
</p><p><b>steps:</b>
</p>
<pre>- irb                                                       #Initializes IRB
- load_lib_create_object                                    #Load rspectests_lib and creates object of the lib                           
- unit_tests:
  - test_submit_job                                         #Test whether the post /jobs REST API is submitting job successfully 
  - test_get_job                                            #Test whether the get /jobs API is getting details of job   
  - test_delete_job                                         #Test whether the delete /jobs API is fine        
  - test_get_version                                        #Test whether GET /version is working fine
  - test_get_timezone                                       #Test whether GET /timezone is working fine
#
# Scenario Testing                                          #Test Scenario 1: Submit a job, check if submitted, Delete job, Check if deleted                      
- scenario1:
  - submit_job
  - test_if_submitted
  - delete_job
  - test_if_deleted
#- print_output                                             #Only 1 print_output should be there in a recipe. It should be put only after all the tests/scenarios 
#
- scenario2:                                                #Test Scenario 2: Test to Submit job, Hold job, Resume job
  - submit_job_running
  - test_if_submitted
  - hold_job_running
  - test_if_job_held
  - resume_job
  - test_if_job_resumed
- print_output                                              #Print output of tests
                        
</pre>
<p>The irb.yaml macrostep: <br />
<b>irb:</b>
</p>
<pre>- create_pipes:
    - exec_appliance: mkfifo irb_stdout                    #Named Fifo pipe to store the output produced after testing in IRB
    - exec_appliance: mkfifo irb_stdin                     #Named Fifo pipe which accepts input for IRB
    - exec_appliance: mkfifo irb_stderr                    #Named Fifo pipe to log the errors produced after testing in IRB
- start_irb:
    - exec_appliance: irb &lt;irb_stdin &gt;irb_stdout &amp;     
    - exec_appliance: IRB_PID=$!
- bash_function:
    - exec_appliance: function write_irb(){ echo "$1" &gt; irb_stdin; }
- clean:
    - exec_appliance: echo "kill $IRB_PID" &gt;&gt; $$workdir/clean.sh
    - exec_appliance: echo "rm -f $$workdir/chroot/irb_stdout" &gt;&gt; $$workdir/clean.sh
    - exec_appliance: echo "rm -f $$workdir/chroot/irb_stdin" &gt;&gt; $$workdir/clean.sh
    - exec_appliance: echo "rm -f $$workdir/chroot/irb_stderr" &gt;&gt; $$workdir/clean.sh
</pre>
<p>This macrostep creates named pipes for input, output and error and initializes a session of IRB. The clean step adds rm -f commands that delete pipes into clean.sh
</p><p>The <b>load_lib_create_object</b> step contains the following microsteps:
</p><p><b>load_lib_create_object:</b>
</p>
<pre>- load_lib_create_object:
  - load_libs:
    - exec_appliance: write_irb "require '$$rpsec_lib_path'" 
  - create_objects:
    - exec_appliance: write_irb "obj = Tests.new($$apiuri)" 
</pre>
<p>Here, the microsteps uses 2 Global variables declared in the Kameleon recipe file which are referenced using $$.They are:<br />
RSpec Library Path and Apiuri Path.<br />
rpsec_lib_path: /home/kameleon/lib/rspectests_lib <br />
apiuri: "<a href="http://kameleon:kameleon@localhost/oarapi-priv" class="external free" title="http://kameleon:kameleon@localhost/oarapi-priv" rel="nofollow">http://kameleon:kameleon@localhost/oarapi-priv</a>"
</p><p>The <b>test_submit_job</b> macrostep will contain the following microsteps:
</p><p><b>test_submit_job:</b>
</p>
<pre>- test_submit_job:                
  - exec_appliance: write_irb "jhash = { 'resource' =&gt; \"/nodes=1/core=1\" , 'script' =&gt; \"ls;pwd;whoami\" }" 
  - exec_appliance: write_irb "obj.test_submit_job(jhash)"  
</pre>
<p>Here, the load_lib_create_object step imports the RSpec Test library file and creates an object of RSpec class, Test. It uses this object to explicitly call the test_submit_job() ruby method which contains the RSpec test element and runs the test element separately.
</p><p>The <b>scenario1</b> macrostep will contain the following microsteps:
</p><p><b>scenario1:</b>
</p>
<pre>- submit_job:
  - exec_appliance: write_irb "jhash = { 'resource' =&gt; \"/nodes=1/core=1\" , 'script' =&gt; \"ls;pwd;whoami;sleep 60\" }"
- test_if_submitted:
  - exec_appliance: write_irb "obj.test_submit_job(jhash)"
  - exec_appliance: write_irb "jid = obj.jobid"
  - exec_appliance: write_irb "puts \"Submitted job \"+jid.to_s"
  - exec_appliance: write_irb "obj.test_job_in_queue(jid)"
- delete_job:
  - exec_appliance: write_irb "puts \"Deleting job \"+jid.to_s"
  - exec_appliance: write_irb "puts jid.to_s"
- test_if_deleted:
  - exec_appliance: write_irb "obj.test_jobs_delete(jid)"
  - exec_appliance: write_irb "obj.test_job_notin_queue(jid)"
  - exec_appliance: write_irb "puts \"Scenario1 successfully tested\""
</pre>
<p>The <b>print_output</b> macrostep contains the following microsteps:
</p><p><b>print_output:</b>
</p>
<pre>- print:
  - exec_appliance: write_irb "exit"
  - exec_appliance: sleep 1
  - exec_appliance: cat irb_stdout|tee output_file
  - exec_appliance: echo "Results of the Testsuite Run"
  - exec_appliance: grep -C 1 "OarApis" output_file
  - exec_appliance: grep failure output_file&gt;numexamples
  - exec_appliance: cat numexamples|wc -l|sed 's/^/Total Number of examples run:/'
  - exec_appliance: awk -F '[ ,]' '{static s; if($4 == 0) s++}; END { print s }' numexamples|sed 's/^/Number of Successes:/'
  - exec_appliance: echo "Time taken to run each tests"
  - exec_appliance: grep seconds output_file|tee testtime
  - exec_appliance: echo "Total Time taken:"
  - exec_appliance: awk '{ static timesum; timesum+=$3 }; END { print timesum }' testtime
</pre>
<p>Only 1 print_output microstep should be present in the recipe file. If 2 scenario testings needs to be done,place print_output step after 2nd scenario. This will contain the output of tests of both the scenarios.
</p><p>Notice here that print_output microstep is rather big. The intention was to add more creativity in the output after the test run. It can also be rather small and simple; depends on the requirements of the tester.
</p>
<a name="Schema" id="Schema"></a><h2> <span class="mw-headline">Schema</span></h2>
<p><a href="index.php/File:Irb_config.jpg.html" class="image" title="Image:Irb_config.jpg"><img alt="Image:Irb_config.jpg" src="images/7/76/Irb_config.jpg" width="787" height="255" border="0" /></a>
</p><p><a href="index.php/File:Irb_IO.jpg.html" class="image" title="Image:Irb_IO.jpg"><img alt="Image:Irb_IO.jpg" src="images/f/f9/Irb_IO.jpg" width="814" height="285" border="0" /></a>
</p><p><a href="index.php/File:Rspectestslib.jpg.html" class="image" title="Image:Rspectestslib.jpg"><img alt="Image:Rspectestslib.jpg" src="images/b/b4/Rspectestslib.jpg" width="842" height="576" border="0" /></a>
</p><p><a href="index.php/File:Overall_Flow.jpg.html" class="image" title="Image:Overall_Flow.jpg"><img alt="Image:Overall_Flow.jpg" src="images/1/1a/Overall_Flow.jpg" width="628" height="621" border="0" /></a>
</p>
<a name="List_of_rspectests_lib_methods" id="List_of_rspectests_lib_methods"></a><h2> <span class="mw-headline">List of rspectests_lib methods</span></h2>
<p>The <b>rspectests_lib</b> currently contains the following methods/rspec test elements. As and when more lib methods are required, it can be easily added to the library.
The OAR REST APIs are called by this library using the oarrestapi_lib library. 
For writing tests, one has the flexibility to require either rspectests_lib or oarrestapi_lib based on their specific requirements.
</p><p><b>Class: Test</b>
</p><p><b>Methods:</b>
</p>
<pre> 1. test_get_version                  - Testing the GET /version REST API
 2. test_get_timezone                 - Testing the GET /timezone REST API
 3. test_get_jobs_details             - Testing the GET /jobs/details REST API
 4. test_get_running_jobs             - Testing the GET /jobs REST API
 5. test_get_jobs_id (jid)            - Testing the GET /jobs/&lt;ID&gt; REST API
 6. test_job_in_queue(jid)            - Test to check if job is there in queue GET /jobs/details API
 7. test_job_notin_queue(jid)         - Test to check if job is deleted from queue using GET /jobs/details API
 8. test_get_jobs_table               - Testing the GET /jobs/table REST API
 9. test_submit_job (jhash)           - Testing the POST /jobs REST API
10. test_jobs_delete_post (jid)       - Testing the POST /jobs/id/deletions/new REST API
11. test_jobs_delete (jid)            - Testing the DELETE /jobs/&lt;id&gt; REST API
12. test_get_resources                - Testing the GET /resources REST API
13. test_get_resources_full           - Testing the GET /resources/full REST API
14. test_job_rholds (jid)             - Testing the POST /jobs/&lt;id&gt;/rholds/new REST API
15. test_job_hold (jid)	           - Testing the POST /jobs/&lt;jobid&gt;/holds/new REST API
16. test_job_resumption (jid)         - Testing the POST /jobs/&lt;id&gt;/resumption/new REST API
17. test_job_update (jid, actionhash) - Testing POST /jobs/&lt;id&gt;/ API (deleting use when browsers dont support DELETE)
18. test_if_job_delete_updated (jid)  - Testing POST /jobs/&lt;id&gt;/ to see if job is updated with actionhash, Call this after calling above method
19. test_job_checkpoint (jid)         - Testing the POST /jobs/&lt;jobid&gt;/checkpoints/new REST API
20. test_job_running (jid)            - Testing if job is currently running  
</pre>
<a name="List_of_oarrestapi_lib_methods" id="List_of_oarrestapi_lib_methods"></a><h2> <span class="mw-headline">List of oarrestapi_lib methods</span></h2>
<p>The rspectests_lib call the OAR REST APIs through the <b>oarrestapi_lib</b> library.
</p><p><b>Class: OarApi</b>
</p><p><b>Methods:</b>
</p>
<pre> 1. get(api,uri)                      - GET REST OAR API; Function to get objects from the api
 2. post(api,uri,j)		       - POST REST OAR API; Function to create/delete/hold/resume objects through the api
 3. delete(api, uri)		       - DELETE REST OAR API; Function to Delete objects through the api
 4. oar_version		       - Gives version info &amp; Timezone about OAR and OAR API/Server.
 5. oar_timezone		       - Gives the timezone of the OAR API server.
 6. full_job_details		       - List the current jobs &amp; some details like assigned resources
 7. run_job_details                   - List currently running jobs
 8. specific_job_details(jobid)       - Get Details of a specific job
 9. dump_job_table		       - Dump the jobs table (only current jobs)
10. submit_job(jhash)		       - Submits job
11. del_job(jobid)                    - Delete job - POST /jobs/id/deletions/new
12. send_checkpoint(jobid)            - Send checkpoint signal to a job
13. hold_waiting_job(jobid)	       - Hold a Waiting job
14. hold_running_job(jobid)           - Hold a Running job
15. resume_hold_job(jobid)            - Resume a Holded job
16. send_signal_job(jobid, signo)     - Send signal to a job with signalno.
17. update_job(jobid, actionhash)     - Update a job
18. resource_list_state               - Get list of Resources and state
19. list_resource_details             - Get list of all the resources and all their details
20. specific_resource_details(jobid)  - Get details of resources identified by an ID
21. resource_of_nodes(netaddr)        - Get details about the resources belonging to the node identified by network address
22. create_resource(rhash)            - Create Resource
23. statechange_resource(jid,harray)  - Change the state of resources of a job
24. delete_job(jobid)		       - Delete or kill a job using DELETE API
25. delete_resource(resid)            - Delete the resource identified by id
26. delete_resource_cpuset(node,cpuid)- Delete the resource corresponding to cpuset id on node node.
</pre>
<a name="TODO_list" id="TODO_list"></a><h2> <span class="mw-headline">TODO list</span></h2>
<ul><li> <s>Create a library calling various OAR REST APIs, with Error Management.</s>
</li><li> <s>Find out how named pipes can be used to provide inputs and accept output/errors from IRB </s>
</li><li> <s>Create a library of RSpec tests with basic and scenario testing of the OAR APIs.</s>
</li><li> <s>Change names of some methods and classes to meet OAR Coding conventions.</s>
</li><li> <s>Make APIURI as a global variable in kameleon recipe. Also make path of libs used in "require" as a kameleon global variable .</s>
</li><li> <s>Split the tests.yaml to 2, lib and unit_test; lib will contain load_lib and create_object. Create a separate print_output step.</s>
</li><li> <s>Make more detailed schema to show how the various layers interact to give the test results..(From recipe to IRB and so on)</s>
</li><li> <s>Write Testcases in simple RSpec Files and compare the speed of execution via kameleon and from without kameleon.</s>
</li><li> <s>Test testsuite codes, recipes and steps in a virgin appliance to see if issue due to non-availability of .irbrc file occurs. If occurs, next ToDo.</s>
</li><li> <s>Find out how to set IRBRC environment variable to point to .irbrc configuration file in a generic path under /, overriding the default search in ~/.irbrc.</s>
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 51/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
#ifexist count: 0/100
-->

<!-- Saved in parser cache with key wikioar:pcache:idhash:222-0!1!0!!en!2!edit=0!printable=1 and timestamp 20150721145229 -->
<div class="printfooter">
Retrieved from "<a href="index.php/Test_Suite_GSOC_2010.html">http://wiki-oar.imag.fr/index.php/Test_Suite_GSOC_2010</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="index.php/Test_Suite_GSOC_2010.html" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="http://wiki-oar.imag.fr/index.php?title=Talk:Test_Suite_GSOC_2010&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;action=edit.html" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;action=history.html" title="Past revisions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="index.php%3Ftitle=Special:UserLogin&amp;returnto=Test_Suite_GSOC_2010.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://oar.imag.fr/schemas/oar_logo_small.png);" href="index.html" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-Public_portal'>
		<h5>Public portal</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="index.html" title="Visit the main page">Main Page</a></li>
				<li id="n-Appliances-.28Kameleon.29"><a href="index.php/Kameleon.html">Appliances (Kameleon)</a></li>
				<li id="n-OAR-Website"><a href="http://oar.imag.fr">OAR Website</a></li>
				<li id="n-REST-API"><a href="index.php/RESTfullAPI.html">REST API</a></li>
				<li id="n-Customization-tips"><a href="index.php/Configuration_tips.html">Customization tips</a></li>
				<li id="n-OAR.27s-News"><a href="http://oar.imag.fr/news/">OAR's News</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-Summer_of_Code'>
		<h5>Summer of Code</h5>
		<div class='pBody'>
			<ul>
				<li id="n-GSoC-Summary"><a href="index.php/Google_summer_of_code.html">GSoC Summary</a></li>
				<li id="n-2010-edition"><a href="index.php/GSOC_2010.html">2010 edition</a></li>
				<li id="n-2009-edition"><a href="index.php/GSOC_2009.html">2009 edition</a></li>
				<li id="n-2008-edition"><a href="http://oar.imag.fr/works/gsoc/2008/">2008 edition</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-Related_links'>
		<h5>Related links</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Summary"><a href="index.php/Links.html">Summary:</a></li>
				<li id="n-About-OAR-.28French.29"><a href="http://www.projet-plume.org/fr/fiche/oar">About OAR (French)</a></li>
				<li id="n-TakTuk"><a href="http://taktuk.gforge.inria.fr/">TakTuk</a></li>
				<li id="n-CiGri"><a href="http://cigri.imag.fr/">CiGri</a></li>
				<li id="n-Kameleon"><a href="index.php/Kameleon.html">Kameleon</a></li>
				<li id="n-ComputeMode"><a href="http://computemode.imag.fr/">ComputeMode</a></li>
				<li id="n-Xionee"><a href="https://gforge.inria.fr/projects/xionee/">Xionee</a></li>
				<li id="n-KaDeploy"><a href="http://kadeploy.imag.fr/">KaDeploy</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-Developers_portal'>
		<h5>Developers portal</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Summary"><a href="index.php/Developers_Pages.html">Summary:</a></li>
				<li id="n-Meetings-reports"><a href="index.php/Category:Portal:Staff:MeetingReports.html">Meetings reports</a></li>
				<li id="n-Assigned-TaskList"><a href="index.php/Special:TaskList/all.html">Assigned TaskList</a></li>
				<li id="n-Todo-Page"><a href="index.php/TODO.html">Todo Page</a></li>
				<li id="n-Tools-and-Tips"><a href="index.php/Devel_Tools_tips.html">Tools and Tips</a></li>
				<li id="n-FAQ"><a href="index.php/FAQ.html">FAQ</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://wiki-oar.imag.fr/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search WikiOAR [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="index.php/Special:WhatLinksHere/Test_Suite_GSOC_2010.html" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="index.php/Special:RecentChangesLinked/Test_Suite_GSOC_2010.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="index.php/Special:SpecialPages.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;printable=yes&amp;printable=yes.html" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="index.php%3Ftitle=Test_Suite_GSOC_2010&amp;oldid=2720.html" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 16 August 2010, at 17:48.</li>
					<li id="viewcount">This page has been accessed 13,662 times.</li>
					<li id="about"><a href="index.php/WikiOAR:About.html" title="WikiOAR:About">About WikiOAR and OAR logo</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.092 secs. --></body></html>
