<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.5-2squeeze6" />
		<meta name="robots" content="noindex,nofollow" />
		<meta name="keywords" content="Construction of the Grid5000 image &#039;lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR&#039;,Lenny-x64-base-0.9,Grenoble:Home,Computer,TGZ-G5K" />
		<link rel="shortcut icon" href="http://oar.imag.fr/images/logo_oar.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="WikiOAR (en)" />
		<link rel="alternate" type="application/rss+xml" title="WikiOAR RSS feed" href="index.php%3Ftitle=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="WikiOAR Atom feed" href="index.php%3Ftitle=Special:RecentChanges&amp;feed=atom" />
		<title>Construction of the Grid5000 image 'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR' - WikiOAR</title>
		<link rel="stylesheet" href="skins/common/shared.css%3F207.css" type="text/css" media="screen" />
		<link rel="stylesheet" href="skins/common/commonPrint.css%3F207.css" type="text/css" media="print" />
		<link rel="stylesheet" href="skins/monobook/main.css%3F207.css" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE50Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE55Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="index.php%3Ftitle=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%252Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000.css" type="text/css" />
		<link rel="stylesheet" href="index.php%3Ftitle=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%252Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000.css" type="text/css" media="print" />
		<link rel="stylesheet" href="index.php%3Ftitle=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%252Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000.css" type="text/css" />
		<link rel="stylesheet" href="index.php%3Ftitle=-&amp;action=raw&amp;maxage=18000&amp;gen=css.css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins";
		var wgArticlePath = "/index.php/$1";
		var wgScriptPath = "";
		var wgScript = "/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://oar.imag.fr/archive/wiki-oar";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Construction_of_the_Grid5000_image_\'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR\'";
		var wgTitle = "Construction of the Grid5000 image \'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR\'";
		var wgAction = "view";
		var wgArticleId = "111";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 1447;
		var wgVersion = "1.15.5-2squeeze6";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="skins/common/wikibits.js%3F207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="skins/common/ajax.js%3F207"></script>
		<script type="text/javascript" src="index.php%3Ftitle=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Construction_of_the_Grid5000_image_lenny2_6_26-OAR2_4_0-SLURM2_0_0-BLCR skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Construction of the Grid5000 image 'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR'</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From WikiOAR</h3>
			<div id="contentSub">
				<div id="mw-revision-info">Revision as of 10:43, 13 August 2009 by <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=User:Ygeorgiou&amp;action=edit&amp;redlink=1" class="new mw-userlink" title="User:Ygeorgiou (page does not exist)">Ygeorgiou</a>  <span class="mw-usertoollinks">(<a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=User_talk:Ygeorgiou&amp;action=edit&amp;redlink=1" class="new" title="User talk:Ygeorgiou (page does not exist)">Talk</a>&#32;|&#32;<a href="index.php/Special:Contributions/Ygeorgiou.html" title="Special:Contributions/Ygeorgiou">contribs</a>)</span></div>

				<div id="mw-revision-nav">(<a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Construction_of_the_Grid5000_image_%27lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%27&amp;diff=prev&amp;oldid=1447" title="Construction of the Grid5000 image &#039;lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR&#039;">diff</a>) <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Construction_of_the_Grid5000_image_%27lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%27&amp;direction=prev&amp;oldid=1447" title="Construction of the Grid5000 image &#039;lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR&#039;">← Older revision</a>&#32;|&#32;Latest revision (diff)&#32;|&#32;Newer revision → (diff)</div>
			</div>
									<div id="jump-to-nav">Jump to: <a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#column-one">navigation</a>, <a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#searchInput">search</a></div>			<!-- start content -->
			<p><code>lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR</code> is derived from <code><a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Lenny-x64-base-0.9&amp;action=edit&amp;redlink=1" class="new" title="Lenny-x64-base-0.9 (page does not exist)">Lenny-x64-base-0.9</a></code> to provide a minimal debian environment with more recent software.
</p>
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Identification_sheet"><span class="tocnumber">1</span> <span class="toctext">Identification sheet</span></a></li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Build"><span class="tocnumber">2</span> <span class="toctext">Build</span></a>
<ul>
<li class="toclevel-2"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Kernel_improvements"><span class="tocnumber">2.1</span> <span class="toctext">Kernel improvements</span></a>
<ul>
<li class="toclevel-3"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#sources"><span class="tocnumber">2.1.1</span> <span class="toctext">sources</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Environment"><span class="tocnumber">3</span> <span class="toctext">Environment</span></a>
<ul>
<li class="toclevel-2"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Creating_image.27s_archive"><span class="tocnumber">3.1</span> <span class="toctext">Creating image's archive</span></a></li>
<li class="toclevel-2"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Recording_environment"><span class="tocnumber">3.2</span> <span class="toctext">Recording environment</span></a></li>
<li class="toclevel-2"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#MPI_libraries"><span class="tocnumber">3.3</span> <span class="toctext">MPI libraries</span></a>
<ul>
<li class="toclevel-3"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#OPENMPI"><span class="tocnumber">3.3.1</span> <span class="toctext">OPENMPI</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Checkpoint.2FRestart_libraries"><span class="tocnumber">3.4</span> <span class="toctext">Checkpoint/Restart libraries</span></a>
<ul>
<li class="toclevel-3"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#BLCR"><span class="tocnumber">3.4.1</span> <span class="toctext">BLCR</span></a></li>
<li class="toclevel-3"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#DMTCP"><span class="tocnumber">3.4.2</span> <span class="toctext">DMTCP</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Resource_Management_Systems"><span class="tocnumber">3.5</span> <span class="toctext">Resource Management Systems</span></a>
<ul>
<li class="toclevel-3"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#OAR2.4.0"><span class="tocnumber">3.5.1</span> <span class="toctext">OAR2.4.0</span></a>
<ul>
<li class="toclevel-4"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Installation"><span class="tocnumber">3.5.1.1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-4"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Configuration"><span class="tocnumber">3.5.1.2</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-5"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#oar.conf_file"><span class="tocnumber">3.5.1.2.1</span> <span class="toctext">oar.conf file</span></a></li>
<li class="toclevel-5"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#CPUSETs"><span class="tocnumber">3.5.1.2.2</span> <span class="toctext">CPUSETs</span></a></li>
</ul>
</li>
<li class="toclevel-4"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Automatic_Cluster_Configuration"><span class="tocnumber">3.5.1.3</span> <span class="toctext">Automatic Cluster Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-3"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#SLURM2.0.0"><span class="tocnumber">3.5.2</span> <span class="toctext">SLURM2.0.0</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Identification_sheet" id="Identification_sheet"></a><h1> <span class="mw-headline"> Identification sheet </span></h1>
<div class="sysimage">
<table border="0" summary="System Image description">

<tr>
<th>
<p>lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR
</p>
</th></tr>
<tr>
<td>
<ul><li> Based on: <b>Debian</b> version <i>lenny</i> for <i>amd64</i>
</li><li> Reference file: <code class="file">/home/grenoble/ygeorgiou/Images/lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR.tgz</code> at <b><a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Grenoble:Home&amp;action=edit&amp;redlink=1" class="new" title="Grenoble:Home (page does not exist)">Grenoble</a></b> (md5sum is <code>{{{ref_md5sum}}}</code>)
</li><li> Valid on: <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">Dell PE1855</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">Dell PE1950</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">HP DL140G3</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">HP DL145G2</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">IBM x3455</a>,<a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">IBM e325</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">IBM e326</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">IBM e326m</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">Sun V20z</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">Sun X2200 M2</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">Sun X4100</a>, <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Computer&amp;action=edit&amp;redlink=1" class="new" title="Computer (page does not exist)">Altix Xe 310</a>
</li></ul>
</td></tr>
<tr>
<td class="notfirst">
<p><b>Kernel</b> version <i>2.6.26</i> from <i>kernel.org</i> for <i>AMD-64</i>
</p>
</td></tr>
<tr>
<td class="notfirst">
<p><b>Authentication</b>
</p>
<ul><li> Remote console: <a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Remote_console" title="">enabled</a> on <i>ttyS0</i> at <i>34800</i> bps
</li><li> Services: <b>ldap:no</b>, nfs:no
</li><li> Accounts: <b>root:grid5000</b>, g5k:grid5000
</li></ul>
</td></tr>
<tr>
<td class="notfirst">
<p><b>Applications</b>
</p>
<ul><li> Text: <a href="http://www.vim.org/" class="external text" title="http://www.vim.org/" rel="nofollow">Vim</a>, <a href="http://www.xemacs.org" class="external text" title="http://www.xemacs.org" rel="nofollow">XEmacs</a>, <a href="http://www.jedsoft.org/jed/" class="external text" title="http://www.jedsoft.org/jed/" rel="nofollow">JED</a>, <a href="http://www.nano-editor.org/" class="external text" title="http://www.nano-editor.org/" rel="nofollow">nano</a>, <a href="http://joe-editor.sourceforge.net/" class="external text" title="http://joe-editor.sourceforge.net/" rel="nofollow">JOE</a>
</li><li> Script: <a href="http://www.perl.org" class="external text" title="http://www.perl.org" rel="nofollow">Perl</a>, <a href="http://www.python.org/" class="external text" title="http://www.python.org/" rel="nofollow">Python</a>, <a href="http://www.ruby-lang.org" class="external text" title="http://www.ruby-lang.org" rel="nofollow">Ruby</a>
</li></ul>
</td></tr>
<tr>
<td class="notfirst">
<p><b> Misc </b>
</p>
<ul><li> <code>ia32</code>/<code>i386</code> shared libraries are available
</li><li> <code>SSH</code> has <code>X11</code> forwarding enabled
</li><li> <a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#Max_open_file_descriptors" title="">Max open files</a>: 8192
</li><li> <a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html#TCP_bandwidth" title="">TCP bandwidth</a>: for 1Gbs
</li></ul>
</td></tr></table>
</div>
<a name="Build" id="Build"></a><h1> <span class="mw-headline"> Build </span></h1>
<p>Here are explanations on how the system was installed and tuned starting from the content of the <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Lenny-x64-base-0.9&amp;action=edit&amp;redlink=1" class="new" title="Lenny-x64-base-0.9 (page does not exist)">Lenny-x64-base-0.9</a> environment.
</p>
<a name="Kernel_improvements" id="Kernel_improvements"></a><h2> <span class="mw-headline"> Kernel improvements </span></h2>
<a name="sources" id="sources"></a><h3> <span class="mw-headline"> sources </span></h3>
<p>We need to modify the kernel.
</p><p>We download the 2.6.26 kernel release from kernel.org.
</p>
<pre>wget <a href="http://www.fr.kernel.org/pub/linux/kernel/v2.6/linux-2.6.26.tar.bz2" class="external free" title="http://www.fr.kernel.org/pub/linux/kernel/v2.6/linux-2.6.26.tar.bz2" rel="nofollow">http://www.fr.kernel.org/pub/linux/kernel/v2.6/linux-2.6.26.tar.bz2</a>
</pre>
<p>The archive need to be extracted at the good place.
</p>
<pre>cd /usr/src
tar jxf /root/linux-2.6.26.tar.bz2
ln -sf /usr/src/linux-2.6.26 /usr/src/linux

</pre>
<p>And some configuration should be done with&nbsp;:
</p>
<pre>cd /usr/src/linux
cp /boot/config-2.6.24.3 .config  
</pre>
<p>We then make our choices for the modules we want to use, specially for power management: cpufreq and acpi...
</p>
<pre>make 
make modules_install
</pre>
<pre>mkinitramfs -o /boot/initrd.img-2.6.26 2.6.26
</pre>
<a name="Environment" id="Environment"></a><h1> <span class="mw-headline"> Environment </span></h1>
<a name="Creating_image.27s_archive" id="Creating_image.27s_archive"></a><h2> <span class="mw-headline"> Creating image's archive </span></h2>
<p>As for <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Lenny-x64-base-0.9&amp;action=edit&amp;redlink=1" class="new" title="Lenny-x64-base-0.9 (page does not exist)">Lenny-x64-base-0.9</a>, system archive creation and retrieving is done with <a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=TGZ-G5K&amp;action=edit&amp;redlink=1" class="new" title="TGZ-G5K (page does not exist)">TGZ-G5K</a>:
</p>
<pre><code class="command">tgz-g5k</code> ygeorgiou@chartreuse:~/Images/lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR.tgz
</pre>
<a name="Recording_environment" id="Recording_environment"></a><h2> <span class="mw-headline"> Recording environment </span></h2>
<p>Recording environment can be done from a description file. So we create <code class="file">lenny-x64-base-0.9.dsc</code>:
</p>
<pre>name = lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR
description = based on <a href="https://www.grid5000.fr/index.php/Lenny-x64-base-0.9" class="external free" title="https://www.grid5000.fr/index.php/Lenny-x64-base-0.9" rel="nofollow">https://www.grid5000.fr/index.php/Lenny-x64-base-0.9</a> 
author = yiannis.georgiou@imag.fr
filebase = file:///home/grenoble/ygeorgiou/lenny-x64-base-0.9.tgz
filesite = file:///grid5000/postinstalls/lenny-x64-base-0.9-post.tgz
size = 1000
initrdpath = /boot/initrd.img-2.6.26
kernelpath = /boot/vmlinuz-2.6.26
fdisktype = 83
filesystem = ext2
</pre>
<p>With <code>karecordenv</code>, the new environment can be known by Kadeploy:
</p>
<pre><code class="command">karecordenv</code> -fe <code class="file">lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR.dsc</code>
</pre>
<p><br />
</p><p><br />
This is the procedure followed to construct the image used for the comparison experiments of OAR with other Resource Management Systems.
</p>
<a name="MPI_libraries" id="MPI_libraries"></a><h2> <span class="mw-headline">MPI libraries</span></h2>
<a name="OPENMPI" id="OPENMPI"></a><h3> <span class="mw-headline">OPENMPI</span></h3>
<a name="Checkpoint.2FRestart_libraries" id="Checkpoint.2FRestart_libraries"></a><h2> <span class="mw-headline">Checkpoint/Restart libraries</span></h2>
<a name="BLCR" id="BLCR"></a><h3> <span class="mw-headline">BLCR</span></h3>
<a name="DMTCP" id="DMTCP"></a><h3> <span class="mw-headline">DMTCP</span></h3>
<a name="Resource_Management_Systems" id="Resource_Management_Systems"></a><h2> <span class="mw-headline">Resource Management Systems</span></h2>
<a name="OAR2.4.0" id="OAR2.4.0"></a><h3> <span class="mw-headline">OAR2.4.0</span></h3>
<a name="Installation" id="Installation"></a><h4> <span class="mw-headline">Installation</span></h4>
<ul><li>Installation of Taktuk package (debian stable). Used by OAR for optimal nodes communication.
</li></ul>
<pre>apt-get install taktuk
</pre>
<ul><li>Installation of mysql-server 
</li><li>Installation of perl, perl-base, perl-dbi, libmysql, perl-suid, perl-mysql, openssh 
</li></ul>
<p>even if most of them will be automatically installed when  installing the OAR debian packages
</p>
<ul><li>Installation of latest OAR unstable packages:  oar-common, oar-doc, oar-user, oar-node, oar-server
</li></ul>
<p>downloaded from: <a href="http://oar.imag.fr/debian/unstable/2.4/" class="external free" title="http://oar.imag.fr/debian/unstable/2.4/" rel="nofollow">http://oar.imag.fr/debian/unstable/2.4/</a>
</p>
<ul><li>add:
</li></ul>
<pre>environment="OAR_KEY=1"
</pre>
<p>at the beginning of the public key in the ~oar/.ssh/authorized_keys file
</p>
<a name="Configuration" id="Configuration"></a><h4> <span class="mw-headline">Configuration</span></h4>
<a name="oar.conf_file" id="oar.conf_file"></a><h5> <span class="mw-headline">oar.conf file</span></h5>
<p>Since we will be using taktuk for nodes communication we have to uncomment the following lines in the oar.conf file
</p>
<pre>TAKTUK_CMD="/usr/bin/taktuk -t 30 -s"
PINGCHECKER_TAKTUK_ARG_COMMAND="broadcast exec timeout 5 kill 9 [ true ]"
</pre>
<a name="CPUSETs" id="CPUSETs"></a><h5> <span class="mw-headline">CPUSETs</span></h5>
<p>The cpuset feature will allow OAR to restrict the use of one (or a group) of cpu for a job. Each computing resource has a cpuset field that will refer to the cpu id that will run the job for this resource.
</p><p>In order to use this feature, we have to uncomment the following lines in the oar.conf file.
</p>
<pre>JOB_RESOURCE_MANAGER_PROPERTY_DB_FIELD="cpuset"
JOB_RESOURCE_MANAGER_FILE="/etc/oar/job_resource_manager.pl"
CPUSET_PATH="/oar"
</pre>
<a name="Automatic_Cluster_Configuration" id="Automatic_Cluster_Configuration"></a><h4> <span class="mw-headline">Automatic Cluster Configuration</span></h4>
<ul><li>In order to configure your OAR cluster upon Grid5000 you need to execute launch_OAR.sh script on the server with the names of the computing nodes as arguments.
</li></ul>
<p>It could be done with the following command directly from the initial sites frontal:
</p>
<pre>sort -u $OAR_NODEFILE | tail -5 | ssh -l g5k $(sort -u $OAR_NODEFILE | head -1) "xargs ~g5k/launch_OAR.sh"
</pre>
<p>if we imagine that we have 1 server and 5 computing nodes.
the same thing could be achieved if we do&nbsp;:
</p>
<pre>./launch_OAR.sh node1 node2 node3 node4 node5 
</pre>
<p>upon the possible OAR server of our cluster
</p><p>In the case of 'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR' image the script launch_OAR.sh contains the following:
</p>
<pre>#!/bin/sh
sudo /etc/init.d/nfs-kernel-server start
sudo /etc/init.d/mysql start
sudo /etc/init.d/oar-server restart
#start nfs, mysql and oar servers
#prepare the arguments to use as parameters in taktuk command for faster execution of configuration commands upon the nodes
taktuk_parameters=""
for node in $@
do
   taktuk_parameters="$taktuk_parameters -m $node"
   echo $node &gt;&gt; /tmp/hostfile
done
HOSTNAME=$(hostname)
#stop oar-server on all the computing nodes of the cluster
taktuk $taktuk_parameters broadcast exec [ 'sudo /etc/init.d/oar-server stop' ]
#declare the oar-server , nfs-server for all the computing nodes
taktuk $taktuk_parameters broadcast exec [ "sudo mount $HOSTNAME:/home/g5k /home/g5k" ]
#prepare oar-node for energy saving feature upon each computing node, comment next 7 lines if energy saving feature not used
sudo sh -c "sed s/localhost/$HOSTNAME/ /home/g5k/conf_files/oar-node &gt; /tmp/oar-node"
taktuk $taktuk_parameters broadcast exec [ "sudo chown g5k /etc/default" ]
taktuk $taktuk_parameters broadcast exec [ "sudo chown g5k /etc/default/oar-node" ]
taktuk $taktuk_parameters broadcast put [ /tmp/oar-node ] [ /etc/default/oar-node ]
taktuk $taktuk_parameters broadcast exec [ "sudo chown root /etc/default" ]
taktuk $taktuk_parameters broadcast exec [ "sudo chown root /etc/default/oar-node" ]
taktuk $taktuk_parameters broadcast exec [ "sudo chgrp root /etc/default/oar-node" ] 
#the following line checks the cluster resources and declares them on the OAR database using oarnodesetting command
sudo /usr/sbin/oar_resources_init /tmp/hostfile
# ecological cluster set cm_availability=2147483646 comment if energy saving feature not used
sudo echo "UPDATE resources set cm_availability=2147483646" | mysql -uroot oar
</pre>
<a name="SLURM2.0.0" id="SLURM2.0.0"></a><h3> <span class="mw-headline">SLURM2.0.0</span></h3>
<ul><li>Install Munge... easy using .deb files
</li><li> adduser slurm
</li><li> cd slurm_dir
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 82/1000000
Post-expand include size: 1814/2097152 bytes
Template argument size: 1307/2097152 bytes
Expensive parser function count: 0/100
#ifexist count: 0/100
-->
<div class="printfooter">
Retrieved from "<a href="index.php/Construction_of_the_Grid5000_image_'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR'.html">http://oar.imag.fr/archive/wiki-oar/index.php/Construction_of_the_Grid5000_image_%27lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%27</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="index.php/Special:Categories.html" title="Special:Categories">Category</a>:&#32;<span dir='ltr'><a href="index.php%3Ftitle=Category:Maintainer:Yiannis_Georgiou&amp;action=edit&amp;redlink=1.html" class="new" title="Category:Maintainer:Yiannis Georgiou (page does not exist)">Maintainer:Yiannis Georgiou</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="index.php/Construction_of_the_Grid5000_image_'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR'.html" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Talk:Construction_of_the_Grid5000_image_%27lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%27&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;action=edit.html" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;action=history.html" title="Past revisions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="index.php%3Ftitle=Special:UserLogin&amp;returnto=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://oar.imag.fr/schemas/oar_logo_small.png);" href="index.html" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-Public_portal'>
		<h5>Public portal</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="index.html" title="Visit the main page">Main Page</a></li>
				<li id="n-Appliances-.28Kameleon.29"><a href="index.php/Kameleon.html">Appliances (Kameleon)</a></li>
				<li id="n-OAR-Website"><a href="http://oar.imag.fr">OAR Website</a></li>
				<li id="n-REST-API"><a href="index.php/RESTfullAPI.html">REST API</a></li>
				<li id="n-Customization-tips"><a href="index.php/Configuration_tips.html">Customization tips</a></li>
				<li id="n-OAR.27s-News"><a href="http://oar.imag.fr/news/">OAR's News</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-Summer_of_Code'>
		<h5>Summer of Code</h5>
		<div class='pBody'>
			<ul>
				<li id="n-GSoC-Summary"><a href="index.php/Google_summer_of_code.html">GSoC Summary</a></li>
				<li id="n-2010-edition"><a href="index.php/GSOC_2010.html">2010 edition</a></li>
				<li id="n-2009-edition"><a href="index.php/GSOC_2009.html">2009 edition</a></li>
				<li id="n-2008-edition"><a href="http://oar.imag.fr/works/gsoc/2008/">2008 edition</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-Related_links'>
		<h5>Related links</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Summary"><a href="index.php/Links.html">Summary:</a></li>
				<li id="n-About-OAR-.28French.29"><a href="http://www.projet-plume.org/fr/fiche/oar">About OAR (French)</a></li>
				<li id="n-TakTuk"><a href="http://taktuk.gforge.inria.fr/">TakTuk</a></li>
				<li id="n-CiGri"><a href="http://cigri.imag.fr/">CiGri</a></li>
				<li id="n-Kameleon"><a href="index.php/Kameleon.html">Kameleon</a></li>
				<li id="n-ComputeMode"><a href="http://computemode.imag.fr/">ComputeMode</a></li>
				<li id="n-Xionee"><a href="https://gforge.inria.fr/projects/xionee/">Xionee</a></li>
				<li id="n-KaDeploy"><a href="http://kadeploy.imag.fr/">KaDeploy</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-Developers_portal'>
		<h5>Developers portal</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Summary"><a href="index.php/Developers_Pages.html">Summary:</a></li>
				<li id="n-Meetings-reports"><a href="index.php/Category:Portal:Staff:MeetingReports.html">Meetings reports</a></li>
				<li id="n-Assigned-TaskList"><a href="index.php/Special:TaskList/all.html">Assigned TaskList</a></li>
				<li id="n-Todo-Page"><a href="index.php/TODO.html">Todo Page</a></li>
				<li id="n-Tools-and-Tips"><a href="index.php/Devel_Tools_tips.html">Tools and Tips</a></li>
				<li id="n-FAQ"><a href="index.php/FAQ.html">FAQ</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://oar.imag.fr/archive/wiki-oar/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search WikiOAR [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="index.php/Special:WhatLinksHere/Construction_of_the_Grid5000_image_'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR'.html" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="index.php/Special:RecentChangesLinked/Construction_of_the_Grid5000_image_'lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR'.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="index.php/Special:SpecialPages.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="http://oar.imag.fr/archive/wiki-oar/index.php?title=Construction_of_the_Grid5000_image_%27lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%27&amp;oldid=1447&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="index.php%3Ftitle=Construction_of_the_Grid5000_image_%2527lenny2.6.26-OAR2.4.0-SLURM2.0.0-BLCR%2527&amp;oldid=1447.html" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
					<li id="about"><a href="index.php/WikiOAR:About.html" title="WikiOAR:About">About WikiOAR and OAR logo</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.088 secs. --></body></html>
